# docker-compose practica integradora Grupo 1
version: "5"
services:
  productos:
    container_name: contiene_vue
    build: productos/
    image: lorzurlop01/imagen_node:latest
    # Quitar antes de entregar
    volumes:
      - ./productos:/app
    #
    networks:
      red_integradora:
        ipv4_address: 172.19.0.18
    dns: 172.19.0.6

  produccion:
    container_name: contiene_apache
    image: lorzurlop01/imagen_apache:latest
    restart: always
    networks:
      red_integradora:
        ipv4_address: 172.19.0.4
    dns: 172.19.0.6

  tienda:
    container_name: contiene_tomcat
    image: lorzurlop01/imagen_tomcat:latest
    restart: always
    # Quitar antes de entregar
    volumes:
      - ./tienda/build/libs:/usr/local/tomcat/webapps
    #
    networks:
      red_integradora:
        ipv4_address: 172.19.0.3
    command: ["./wait-for-it.sh", "172.19.0.2:3306", "-t", "0","--","catalina.sh","run"]
    dns: 172.19.0.6

  database_tienda:
    container_name: contiene_mysql
    image: mysql:latest
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: admin
    networks:
      red_integradora:
        ipv4_address: 172.19.0.2
    dns: 172.19.0.6

  database_productos:
    container_name: contiene_mongo
    image: mongo:latest
    restart: always
    environment:
      MONGO_INITDB_ROOT_USERNAME: root
      MONGO_INITDB_ROOT_PASSWORD: admin
    networks:
      red_integradora:
        ipv4_address: 172.19.0.5
    dns: 172.19.0.6

  servername:
    container_name: contiene_bind9
    build: Bind9/
    image: lorzurlop01/imagen_bind9:latest
    restart: always
    networks:
      red_integradora:
        ipv4_address: 172.19.0.6
    dns: 172.19.0.6

networks:
  red_integradora:
    name: red_integradora
    driver: bridge
    ipam:
      config:
        - subnet: 172.19.0.0/16